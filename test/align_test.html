<!DOCTYPE html>
<!--[if lt IE 7]>      <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]>         <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]>         <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!-->
<html class="no-js">
<!--<![endif]-->

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
    <title>Text Alignment Test</title>

    <script src="../bower_components/jquery/dist/jquery.min.js"></script>

    <script src="../bower_components/underscore/underscore-min.js"></script>
    <!--script src="../bower_components/lodash/dist/lodash.min.js"></script-->

    <!-- Snap.svg -->
    <script src="../bower_components/snap.svg/dist/snap.svg.js"></script>
    <script src="../bower_components/bower-webfontloader/webfont.js"></script>

    <!-- or Raphael -->
    <!-- <script src="../bower_components/raphael/raphael.min.js"></script> -->

    <script src="../build/diagram-grammar.js"></script>
    <script src="../src/theme.js"></script>
    <script src="../src/theme-snap.js"></script>
    <!-- <script src="../src/theme-raphael.js"></script> -->
    <!-- <script src="../fonts/daniel/daniel_700.font.js"></script> -->

    <script src="../src/sequence-diagram.js"></script>
    <script src="../src/jquery-plugin.js"></script>

    <script type="text/javascript">

        $(document).ready(function () {
            function setDiagramType(o, t) {
                Object.setPrototypeOf(o, t == undefined ? Diagram.prototype : eval("Diagram." + t + ".prototype"));
            }
            function resetblock(b) {
                b.partition.forEach(p => p.child.forEach(c => {
                    if (c.type != undefined) { setDiagramType(c, c.type) }
                    else if ('partition' in c) {
                        resetblock(c);
                    }
                }));
            }
            diagram = { "title": "一个时序图", "actors": [{ "alias": "实例: 类", "name": "实例: 类", "index": 0, "textBB": { "x": -1, "y": -17, "width": 58.59375, "w": 58.59375, "height": 21, "h": 21, "x2": 57.59375, "y2": 4, "cx": 28.296875, "cy": -6.5, "r1": 10.5, "r2": 29.296875, "r0": 31.121646562571605, "path": [["M", -1, -17], ["l", 58.59375, 0], ["l", 0, 21], ["l", -58.59375, 0], ["z"]], "vb": "-1 -17 58.59375 21" }, "x": 0, "y": 213.203125, "width": 98.59375, "height": 61, "distances": [null, 167.65625], "paddingRight": 0 }, { "alias": "服务", "name": "服务", "index": 1, "textBB": { "x": 0, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", 0, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "0 -17 33 21" }, "x": 180.453125, "y": 213.203125, "width": 73, "height": 61, "distances": [], "paddingRight": 83 }], "signals": [{ "type": "Signal", "actorA": { "alias": "实例: 类", "name": "实例: 类", "index": 0, "textBB": { "x": -1, "y": -17, "width": 58.59375, "w": 58.59375, "height": 21, "h": 21, "x2": 57.59375, "y2": 4, "cx": 28.296875, "cy": -6.5, "r1": 10.5, "r2": 29.296875, "r0": 31.121646562571605, "path": [["M", -1, -17], ["l", 58.59375, 0], ["l", 0, 21], ["l", -58.59375, 0], ["z"]], "vb": "-1 -17 58.59375 21" }, "x": 0, "y": 213.203125, "width": 98.59375, "height": 61, "distances": [null, 167.65625], "paddingRight": 0 }, "actorB": { "alias": "服务", "name": "服务", "index": 1, "textBB": { "x": 0, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", 0, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "0 -17 33 21" }, "x": 180.453125, "y": 213.203125, "width": 73, "height": 61, "distances": [], "paddingRight": 83 }, "linetype": 0, "arrowtype": 0, "message": "调用\n换行,符号测试\\->:,\\r\n", "textBB": { "x": -1, "y": -17, "width": 147.65625, "w": 147.65625, "height": 40.203125, "h": 40.203125, "x2": 146.65625, "y2": 23.203125, "cx": 72.828125, "cy": 3.1015625, "r1": 20.1015625, "r2": 73.828125, "r0": 76.51578174440245, "path": [["M", -1, -17], ["l", 147.65625, 0], ["l", 0, 40.203125], ["l", -147.65625, 0], ["z"]], "vb": "-1 -17 147.65625 40.203125" }, "width": 167.65625, "height": 60.203125 }, { "type": "Note", "actor": { "alias": "服务", "name": "服务", "index": 1, "textBB": { "x": 0, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", 0, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "0 -17 33 21" }, "x": 180.453125, "y": 213.203125, "width": 73, "height": 61, "distances": [], "paddingRight": 83 }, "placement": 1, "message": "备注", "textBB": { "x": -1, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 32, "y2": 4, "cx": 15.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", -1, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "-1 -17 33 21" }, "width": 63, "height": 51 }], "blocks": [{ "title": "块名", "partition": [{ "text": "如果", "child": [{ "type": "Signal", "actorA": { "alias": "实例: 类", "name": "实例: 类", "index": 0, "textBB": { "x": -1, "y": -17, "width": 58.59375, "w": 58.59375, "height": 21, "h": 21, "x2": 57.59375, "y2": 4, "cx": 28.296875, "cy": -6.5, "r1": 10.5, "r2": 29.296875, "r0": 31.121646562571605, "path": [["M", -1, -17], ["l", 58.59375, 0], ["l", 0, 21], ["l", -58.59375, 0], ["z"]], "vb": "-1 -17 58.59375 21" }, "x": 0, "y": 213.203125, "width": 98.59375, "height": 61, "distances": [null, 167.65625], "paddingRight": 0 }, "actorB": { "alias": "服务", "name": "服务", "index": 1, "textBB": { "x": 0, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", 0, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "0 -17 33 21" }, "x": 180.453125, "y": 213.203125, "width": 73, "height": 61, "distances": [], "paddingRight": 83 }, "linetype": 0, "arrowtype": 0, "message": "调用\n换行,符号测试\\->:,\\r\n", "textBB": { "x": -1, "y": -17, "width": 147.65625, "w": 147.65625, "height": 40.203125, "h": 40.203125, "x2": 146.65625, "y2": 23.203125, "cx": 72.828125, "cy": 3.1015625, "r1": 20.1015625, "r2": 73.828125, "r0": 76.51578174440245, "path": [["M", -1, -17], ["l", 147.65625, 0], ["l", 0, 40.203125], ["l", -147.65625, 0], ["z"]], "vb": "-1 -17 147.65625 40.203125" }, "width": 167.65625, "height": 60.203125 }], "textBB": { "x": -1, "y": -17, "width": 34, "w": 34, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16, "cy": -6.5, "r1": 10.5, "r2": 17, "r0": 19.981241202688086, "path": [["M", -1, -17], ["l", 34, 0], ["l", 0, 21], ["l", -34, 0], ["z"]], "vb": "-1 -17 34 21" }, "textheight": 41, "width": null, "height": null }, { "text": "否则", "child": [{ "partition": [{ "text": "如果", "child": [{ "type": "Note", "actor": { "alias": "服务", "name": "服务", "index": 1, "textBB": { "x": 0, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", 0, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "0 -17 33 21" }, "x": 180.453125, "y": 213.203125, "width": 73, "height": 61, "distances": [], "paddingRight": 83 }, "placement": 1, "message": "备注", "textBB": { "x": -1, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 32, "y2": 4, "cx": 15.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", -1, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "-1 -17 33 21" }, "width": 63, "height": 51 }], "textBB": { "x": -1, "y": -17, "width": 34, "w": 34, "height": 21, "h": 21, "x2": 33, "y2": 4, "cx": 16, "cy": -6.5, "r1": 10.5, "r2": 17, "r0": 19.981241202688086, "path": [["M", -1, -17], ["l", 34, 0], ["l", 0, 21], ["l", -34, 0], ["z"]], "vb": "-1 -17 34 21" }, "textheight": 41, "width": null, "height": null }], "depth": 1, "height": 0, "width": 0 }], "textBB": { "x": 0, "y": -17, "width": 32, "w": 32, "height": 21, "h": 21, "x2": 32, "y2": 4, "cx": 16, "cy": -6.5, "r1": 10.5, "r2": 16, "r0": 19.13765920900464, "path": [["M", 0, -17], ["l", 32, 0], ["l", 0, 21], ["l", -32, 0], ["z"]], "vb": "0 -17 32 21" }, "textheight": 41, "width": null, "height": null }], "depth": 2, "height": 0, "width": 0, "title_": { "TextBB": { "x": -1, "y": -17, "width": 33, "w": 33, "height": 21, "h": 21, "x2": 32, "y2": 4, "cx": 15.5, "cy": -6.5, "r1": 10.5, "r2": 16.5, "r0": 19.557607215607945, "path": [["M", -1, -17], ["l", 33, 0], ["l", 0, 21], ["l", -33, 0], ["z"]], "vb": "-1 -17 33 21" }, "width": 33, "height": 41, "y": 102 } }], "width": 356.453125, "height": 284.203125 };
            setDiagramType(diagram);
            diagram.blocks.forEach(b => {
                resetblock(b)
            });

            diagram.drawSVG('svg', { theme: 'simple' });
            // diagram.drawSVG('svg', { theme: 'hand' });
        });
    </script>
</head>

<body>
    <svg id="svg" width="800" height="600"></svg>

</body>